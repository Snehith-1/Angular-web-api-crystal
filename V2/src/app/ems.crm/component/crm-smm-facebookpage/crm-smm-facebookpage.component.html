<div class="card shadow-sm">

  <div class="card-header bg-whatsapp" style="color: white;">

    <h3 class="card-title"><i class="fab fa-facebook-square" style="font-size: 20px;"></i>&nbsp;&nbsp;Facebook</h3>
    <div style="margin: 13px;">


      <button title="Create Post" data-bs-toggle="modal" data-bs-target="#myModalfacebookpost"
        class="btn-secondary btn-sm text-black me-4 "> <i class="bi bi-send"></i>&nbsp;
        Post</button>
      <span>
        <img id="p-link" data-bs-toggle="modal" data-bs-target="#myModalview2"
          src="{{facebookuser_list[0].profile_picture}}" style="border-radius: 50%; width: 39px; height: 39px;">
        &nbsp; <span data-bs-toggle="modal" data-bs-target="#myModalview2"
          style=" font-size: 14px;">{{facebookuser_list[0].user_name}}</span> </span>
    </div>


  </div>

</div>

<br>
<br>
<div class="row">
  <!-- 
  <div class="col-lg-3 col-md-3 col-sm-3">
    <div class="cardHeadLeads radius-10 border-start border-0 border-3 border-darkgreen">
      <div class="card-body12">
        <div class="d-flex align-items-center">

          <div>
            <h5 class="mb-0 text-secondary"> All Contacts </h5>
            <div>
              <h5 class="my-1 text-info">43</h5>
            </div>

          </div>
          <div class="widgets-icons-2 rounded-circle bg-gradient-darkgreens text-white ms-auto"><i
              class="bi bi-person-lines-fill fs-3"></i>
          </div>
        </div>
      </div>
    </div>
  </div> -->


  <!-- <div class="col-lg-3 col-md-3 col-sm-3">
    <div class="cardHeadLeads radius-10 border-start border-0 border-3 border-darkgreen">
      <div class="card-body12">
        <div class="d-flex align-items-center">

          <div>
            <h5 class="mb-0 text-secondary">Received Messages</h5>
            <div>
              <h5 class="my-1 text-info">5454</h5>
            </div>
          </div>
          <div class="widgets-icons-2 rounded-circle bg-gradient-darkblue text-white ms-auto"><i
              class="fa-solid fa-message"></i>
          </div>
        </div>

      </div>
    </div>
  </div> -->
  <!-- <div class="col-lg-3 col-md-3 col-sm-3">
    <div class="cardHeadLeads radius-10 border-start border-0 border-3 border-darkgreen">
      <div class="card-body12">
        <div class="d-flex align-items-center">
          <div>
            <h5 class="mb-0 text-secondary">Sent Messages</h5>
            <h5 class="mb-0 text-secondary">776</h5>

          </div>
          <div class="widgets-icons-2 rounded-circle bg-gradient-brown text-white ms-auto"><i
              class="fas fa-paper-plane fs-3"></i>
          </div>
        </div>



      </div>
    </div>
  </div> -->
  <!-- <div class="col-lg-3 col-md-3 col-sm-3">
      <div class="cardHeadLeads radius-10 border-start border-0 border-3 border-darkgreen">
        <div class="card-body12">
          <div class="d-flex align-items-center">
            <div>
              <h5 class="mb-0 text-secondary">Total Messages</h5>
              <h5 class="mb-0 text-dark"> 443</h5>
            </div>
            <div class="widgets-icons-2 rounded-circle bg-gradient-violet text-white ms-auto"><i
                class="bi bi-chat-dots-fill fs-3"></i>
            </div>
          </div>

        </div>
      </div>
    </div> -->


  <div class="table-responsive">
    <div class="card card-body m-3 shadow-xl p-3 mb-5 bg-white rounded">
      <table id="facebookpage_list" class="table table-striped table-row-bordered border-bottom gs-7">
        <thead>
          <tr class=" text-white fw-bold fs-6 text-nowrap bg-whatsapp">
            <th style="width:2%">S.No</th>
            <th>Post</th>
            <th>Date Published</th>
            <th>Posted Type</th>
            <th>Caption</th>
            <th>Views</th>
            <th>Comments</th>
            <th>Action</th>
          </tr>
        </thead>
        <tbody>
          <tr
            *ngFor="let data of facebookpage_list ;let i=index;"
            class="align-middle">
            <td>{{i+1}}</td>
            <td>
              <ng-container *ngIf="data.post_type === 'Picture' ">
                <img src="{{ data.post_url }}" alt="" style="width:69%;height:55px;">
              </ng-container>
              <ng-container *ngIf="data.post_type === 'Videos'">
                <video controls style="width:69%;height:55px;">
                  <source [src]="data.post_url" type="video/mp4">
                  Your browser does not support the video tag.
                </video>
              </ng-container>
              <span *ngIf="!data.post_url"></span>
            </td>
            <td style="white-space: nowrap;">{{data.postcreated_time}}</td>
            <td style="white-space: nowrap;">&nbsp;&nbsp;&nbsp;{{data.post_type}}</td>
            <td style="white-space: nowrap;" [innerHTML]="data.caption"></td>

            <td style="white-space: nowrap;">{{data.views_count}}</td>
            <td style="white-space: nowrap;">{{data.comment_message}}</td>
            <td> <button title="View" type="button" data-bs-toggle="modal" class="btn eye-button"
                (click)="onview(data.facebookmain_gid)"><span
                  class="fa-solid fa-eye text-white fs-6"></span></button>&nbsp;
              <button title="Download" type="button" (click)="downloadImage(data.post_url,data.post_type)"
                class="btn download-button">
                <span class="fa-solid fa-download text-white fs-6"></span>
              </button>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>

</div>
<!-- The Modal ADD -->
<div class="modal" id="myModalview2" data-bs-backdrop="static" data-bs-keyboard="false">
  <div class="modal-dialog ">
    <div class="modal-content">

      <!-- Modal Header -->
      <div class="card-header p-1 pb-2 pt-1 rounded-top bg-skyblue">
        <h2 style="margin-top:10px;color:white;font-weight: bold;">
          &nbsp; <i class="fa fa-user" style="color: white; font-size: 20px;"></i>&nbsp;&nbsp;&nbsp;Account Details
        </h2>
      </div>
      <Br>
      <div style="margin-left: 20px;">
        <h2 style="color:#0866FF">Page Name</h2>
        <b style="margin-left: 10px; font-size: 16px;">{{facebookuser_list[0].user_name}}</b>

        <h2 style="color:#0866FF">Page ID</h2>
        <b style="margin-left: 10px;font-size: 16px;"> {{facebookuser_list[0].id}} </b>
        <h2 style="color:#0866FF">Page Category </h2>
        <b style="margin-left: 10px;font-size: 16px;">{{facebookuser_list[0].page_category}}</b>
        <h2 style="color:#0866FF">Invite Link </h2>
        <b>
          <a href="{{facebookuser_list[0].page_link}}"
            style="margin-left: 10px; font-size: 16px;color: #181C32;">{{facebookuser_list[0].page_link}}</a>
        </b>
      </div>
      <div class="text-center my-4">
        <button class="btn-danger btn-sm text-black me-4 " data-bs-dismiss="modal"><i
            class="ki-duotone ki-entrance-right fs-5">
            <i class="path1"></i>
            <i class="path2"></i>
          </i>
          &nbsp;Back
        </button>
      </div>
    </div>
  </div>

  <!-- </div> -->
</div>


<div class="modal" id="myModalfacebookpost" data-bs-backdrop="static" data-bs-keyboard="false"
  style="margin-top: 50px;">
  <div class="modal-dialog ">
    <div class="modal-content">

      <!-- Modal Header -->
      <div class="card-header p-1 pb-2 pt-1 rounded-top bg-primary">
        <h2 style="margin-top:10px;color:white;font-weight: bold;">&nbsp;&nbsp;<i
            class="fas fa-upload fw-bolder fs-3"></i> &nbsp;&nbsp;Facebook Post</h2>
      </div>

      <div class="modal-body">
        <tabset>
          <tab heading="Post">
            <form [formGroup]="FacebookImageForm" #form="ngForm">
              <div class="modal-body">

                <div class="row"><span class="font-bold"><b>Caption</b><span class="ms-1 text-red">*</span></span>
                  <div class="col-lg-12 col-md-12 col-sm-12 fv-row mt-2 d-flex ">


                    <input formControlName="image_caption" type="text" pattern="^(?!\s*$).+" class="
                                                     form-control form-control-lg form-control-solid
                                                     custom-input
                                                     mb-3 mb-lg-0
                                                     bg-white
                                                     custom-input
                                                   " [ngStyle]="{
                                                     'border-color':
                                                     image_caption.invalid && image_caption.touched
                                                         ? 'red'
                                                         : 'rgb(209, 209, 209)'
                                                   }" placeholder="Enter Caption" pattern="^(?!\s*$).+"
                      name="image_caption" required />

                  </div>
                  <div *ngIf="image_caption.invalid && (image_caption.dirty || image_caption.touched)">
                    <div *ngIf="image_caption.errors?.['required']  || image_caption.errors?.['whitespace']">
                      <span style="color:red;">Caption is required.</span>
                    </div>
                  </div>

                </div>
                <br>
                <span class="font-bold"><b>Image/video Only</b><span class="ms-1 text-red">*</span></span>
                <br>
                <div class="input-group mb-4" style="margin-left: 12px;width:97%;">
                  <input class="form-control" accept="image/*, video/*" (change)="onChange2($event)"
                    style="margin-left:-8px;width:30%;" formControlName="file_path" type="file" #fileInput />
                </div>
              </div>
              <!-- Modal footer -->
              <div class="text-center my-4">

                <button (click)="onsubmit()" [disabled]="FacebookImageForm.invalid" [ngClass]="{
                    'primary-button': !FacebookImageForm.invalid,
                    'secondary-button': FacebookImageForm.invalid
                     }" data-bs-dismiss="modal">
                  <i class="fas fa-check text-white fs-5 "></i> &nbsp;Submit
                </button>&nbsp;&nbsp;
                <button class="btn-danger btn-sm text-white me-4" (click)="onclose()" data-bs-dismiss="modal">
                  <i class="fas fa-close text-white"></i> &nbsp;Close
                </button>
              </div>

            </form>
          </tab>
          <tab heading="Schedule">
            <form [formGroup]="FacebookImagescheduleForm" #form="ngForm">

              <div class="col-lg-12 col-md-12 col-sm-12 fv-row mt-2">
                <span class="font-bold"><b>Schedule Date</b><span class="ms-1 text-red">*</span></span>
                <div class="col-xl-12 col-md-12 col-sm-12 fv-row mt-2 d-flex ">
                  <input formControlName="schedule_at" type="date" class="
                               form-control form-control-lg form-control-solid
                               custom-input
                               mb-3 mb-lg-0
                               bg-white
                               custom-input date-picker
                               " [ngStyle]="{
                                'border-color':
                                schedule_at.invalid && schedule_at.touched
                                    ? 'red'
                                    : 'rgb(209, 209, 209)'
                              }" placeholder="" pattern="^(?!\s*$).+" name="schedule_at" required />


                </div>

                <div *ngIf="schedule_at.invalid && (schedule_at.dirty || schedule_at.touched)">
                  <div *ngIf="schedule_at.errors?.['required']">
                    <span style="color:red;">Schedule Date is required.</span>
                  </div>
                </div>
              </div>
              <br>
              <br>
              <div class="row"><span class="font-bold"><b>Caption</b><span class="ms-1 text-red">*</span></span>
                <div class="col-lg-12 col-md-12 col-sm-12 fv-row mt-2 d-flex ">
                  <input formControlName="image_schedulercaption" type="text" pattern="^(?!\s*$).+" class="
                                                   form-control form-control-lg form-control-solid
                                                   custom-input
                                                   mb-3 mb-lg-0
                                                   bg-white
                                                   custom-input
                                                 " [ngStyle]="{
                                                   'border-color':
                                                   image_schedulercaption.invalid && image_schedulercaption.touched
                                                       ? 'red'
                                                       : 'rgb(209, 209, 209)'
                                                 }" placeholder="Enter Caption" pattern="^(?!\s*$).+"
                    name="image_schedulercaption" required />
                </div>
                <div
                  *ngIf="image_schedulercaption.invalid && (image_schedulercaption.dirty || image_schedulercaption.touched)">
                  <div
                    *ngIf="image_schedulercaption.errors?.['required']  || image_schedulercaption.errors?.['whitespace']">
                    <span style="color:red;">Caption is required.</span>
                  </div>
                </div>

              </div>
              <br>
              <span class="font-bold"><b>Image/video Only</b><span class="ms-1 text-red">*</span></span>
              <br>
              <div class="input-group mb-4" style="margin-left: 12px;width:97%;">

                <input class="form-control" accept="image/*, video/*" (change)="onChange2($event)"
                  style="margin-left:-8px;width:30%;" formControlName="file_path" type="file" #fileInput />
              </div>
              <div class="text-center my-4">
                <button (click)="scheduleonsubmit()" [disabled]="FacebookImagescheduleForm.invalid" [ngClass]="{
                  'primary-button': !FacebookImagescheduleForm.invalid,
                  'secondary-button': FacebookImagescheduleForm.invalid
                   }" data-bs-dismiss="modal">
                  <i class="fas fa-check text-white fs-5 "></i> &nbsp;Schedule
                </button>&nbsp;&nbsp;
                <button class="btn-danger btn-sm text-white me-4" (click)="onscheduleclose()" data-bs-dismiss="modal">
                  <i class="fas fa-close text-white"></i> &nbsp;Close
                </button>
              </div>
            </form>
          </tab>
          <tab heading="Log Details">
            <div class="log-details-tab-content">
              <div class="col-12 col-lg-3 col-md-6 col-lg-12">
                <span class="fw-bold" style="font-size: small;"><b>Schedule Log Details
                  </b></span><br /><br />

                <ng-container *ngFor="let schedule of schedule_list; let i = index">
                  <div style="margin-bottom: 5px; padding: 5px; overflow-y: auto; max-height: 300px;"
                    class="panel bg-white">
                    <b>{{schedule.post_type}}-- </b> {{schedule.caption}}
                    <div style="margin-bottom: 3px; margin-top: 2px;">
                      <div class="row">
                        <div class="panel-body" style="font-size: x-small;">
                          <b>Postcreated at-- </b>{{schedule.postcreated_time}} / <b>Schedule
                            at--</b>{{schedule.schedule_at}}
                        </div>
                      </div>
                      <div class="row">
                        <div class="panel-body" style="font-size: x-small;">
                          <B>File Name-- </B>{{schedule.file_name}}

                        </div>
                      </div>
                    </div>
                    <!-- Add a horizontal line after each schedule log -->
                    <hr style="margin-top: 5px; margin-bottom: 5px;">
                  </div>
                </ng-container>
              </div>
            </div>

            <div class="text-center my-4">
              <button class="btn-danger btn-sm text-white me-2" data-bs-dismiss="modal" style="background-color: red;">
                <i class="fas fa-close text-white"></i> &nbsp;Close
              </button>&nbsp;
            </div>
          </tab>
        </tabset>

      </div>
    </div>
  </div>
</div>