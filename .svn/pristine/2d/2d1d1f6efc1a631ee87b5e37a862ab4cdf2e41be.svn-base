<div class="card shadow-sm">
    <div class="card-header bg-whatsapp" style="color: white;">
        <h3 class="card-title"> <i class="fa fa-paper-plane fs-1"></i> &nbsp;&nbsp;
            Send Campaign </h3>
        <div style="margin: 13px">
            <div class="col me-5">
                <button title="Back" routerLink="/crm/CrmSmmWhatsappcampaign"
                    class="btn-secondary btn-sm text-black me-4 "><i class="ki-duotone ki-entrance-right fs-5">
                        <i class="path1"></i>
                        <i class="path2"></i>
                    </i>&nbsp;Back</button>
            </div>
        </div>
    </div>
    <ul class="nav nav-tabs nav-line-tabs nav-line-tabs-20x mb-3 fs-6 border-bottom text-center mt-2" id="myTab"
        role="tablist">
        <li class="active justify-content-center col nav-link sample border rounded-0 p-4 count" data-bs-toggle="tab"
            href="#kt_tab_pane_1">
            <b>Unsent Contacts</b>
        </li>
        <li class="justify-content-center col nav-link sample border rounded-0 p-4 count" data-bs-toggle="tab"
            href="#kt_tab_pane_2">
            <b>Sent Contacts</b>
        </li>
    </ul>
    <div class="tab-content" id="myTabContent">
        <div class="tab-pane fade show active" id="kt_tab_pane_1" role="tabpanel">
            <form [formGroup]="bulkMessageForm" novalidate="novalidate" (ngSubmit)="onsend()">

                <div class=row>
                    <div class=col-9>
                        <div class="table-responsive">
                            <div class="card card-body m-3 shadow-xl p-3 mb-5 bg-white rounded"
                                style=" max-height: 290px; overflow-y: auto;">
                                <!-- <table id="whatsnamelist1"
                                    class="table table-striped table-row-bordered border-bottom gs-7">
                                    <thead>
                                        <tr class=" text-white fw-bold fs-6 text-nowrap bg-whatsapp">
                                            <th style="width:2px;   ">
                                                <input type="checkbox" id="checkAll"
                                                    (change)="$event ? masterToggle() : null"
                                                    [checked]="selection.hasValue() && isAllSelected()"
                                                    [indeterminate]="selection.hasValue() && !isAllSelected()" />
                                            </th>
                                            <th>Name</th>
                                            <th>Contact</th>
                                            <th>Source</th>
                                            <th>Customer Type</th>
                                            <th>Lead Status</th>

                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr *ngFor="let data of contacts_list1; let i=index;" class="align-middle">
                                                <td> <input type="checkbox" (click)="$event.stopPropagation()"
                                                        (change)="$event ? selection.toggle(data) : null"
                                                        [checked]="selection.isSelected(data)" />
                                                </td>
                                                <td style="white-space: nowrap;">{{data.displayName}}</td>
                                                <td style="white-space: nowrap;">{{data.value}}</td>
                                                <td style="white-space: nowrap;">{{data.source_name}}<span
                                                        *ngIf="data.source_name ===''">-</span></td>
                                                <td style="white-space: nowrap;">{{data.customer_type}} <span
                                                        *ngIf="data.customer_type ===''">-</span></td>
                                                <td>
                                                    <span *ngIf="data.lead_status === 'Assigned' "><label class="ms-3"
                                                            class="badge bg-success text-white ">Assigned</label></span><span
                                                        *ngIf="data.customer_type ===''">-</span>

                                                    <span *ngIf="data.lead_status === 'Not Assigned'"><label
                                                            class="ms-3" class="badge bg-primary text-white ">Not
                                                            Assigned</label></span>

                                                </td>
                                        </tr>
                                    </tbody>
                                </table> -->
                                <p-table #dt [value]="contacts_list1" [(selection)]="selectedCustomer"
                                dataKey="whatsapp_gid" [selectionMode]="" [rowHover]="true" [rows]="200"
                                [showCurrentPageReport]="true" [rowsPerPageOptions]="[200, 500,1000, 1500]" [paginator]="true"
                                currentPageReportTemplate="Showing {first} to {last} of {totalRecords} entries" [filterDelay]="0"
                                paginatorDropdownAppendTo="body" compareSelectionBy="equals" [resizableColumns]="true"
                                [globalFilterFields]="['displayName', 'value', 'source_name', 'customer_type']" class="table table-striped table-row-bordered border-bottom gs-7">
                                <ng-template pTemplate="caption">
                                    <div class="row">
                                        <div class="col-6 table-header">
                                            <h3>Contact Summary</h3> <i class="fas fa-exclamation-circle fs-3" style="color: rgb(76, 146, 244);"></i>&nbsp;&nbsp;<span  style="background-color:rgb(189, 237, 246);"><b>Note :</b> Disabled Checkbox Indicates No Contact Number  </span>
                                        </div>
                                        <div class="col-6">
                                            <span class="p-input-icon-left float-end">
                                                <i class="pi pi-search"></i>
                                                <input pInputText class="form-control" type="text"
                                                    (input)="onGlobalFilterChange($event,dt)" placeholder="Search..." />
                                            </span>
                                        </div>
                                    </div>
                                </ng-template>
                                <ng-template pTemplate="header" let-rowIndex="rowIndex">
                                    <tr class="fs-5">
                                        <th style="width: 2px">
                                            <div class="field-checkbox">
                                                <p-tableHeaderCheckbox></p-tableHeaderCheckbox>
                                            </div>
            
                                        </th>
                                        <th pSortableColumn="displayName">
                                            <div class="flex justify-content-between align-items-center text-white">
                                                Name
                                                <p-sortIcon field="displayName"></p-sortIcon>
            
                                            </div>
                                        </th>
                                                                      
                                        <th pSortableColumn="value" >
                                            <div class="flex justify-content-between align-items-center text-white" >Contact <p-sortIcon
                                                    field="value"></p-sortIcon></div>
                                        </th>
            
                                        <th pSortableColumn="source_name">
                                            <div class="flex justify-content-between align-items-center text-white">Source <p-sortIcon
                                                    field="source_name"></p-sortIcon></div>
                                        </th>
            
                                        <th pSortableColumn="customer_type">
                                            <div class="flex justify-content-between align-items-center text-white">Customer Type
                                                <p-sortIcon field="customer_type"></p-sortIcon>
                                            </div>
                                        </th>
                                      
            
                                    </tr>
            
                                </ng-template>
                                <ng-template pTemplate="body" let-customer>
                                    <tr>
                                        <ng-container >
                                            <td>
                                                <p-tableCheckbox [value]="customer" [disabled]="customer.value === ''" [ngClass]="{'highlight-checkbox': customer.value === ''}"></p-tableCheckbox>
            
                                            </td>
            
                                            <td>
                                                <span class="p-column-title">Name</span>
                                                {{ customer.displayName || '-' }}
                                            </td>
                                            <td>
                                                <span class="p-column-title">Contact</span>{{customer.value || '-'}}
            
                                            </td>
                                            <td>
                                                <span class="p-column-title">Source </span>
                                                {{customer.source_name|| '-'}}
                                            </td>
                                            <td>
                                                <span class="p-column-title">Customer Type</span>
                                                {{customer.customer_type|| '-'}}
                                            </td>
                                        </ng-container>
                                    </tr>
                                </ng-template>
                                <!-- <ng-template pTemplate="paginatorright" let-state>
                                    Total Records: {{ state.totalRecords }}
                                </ng-template>  -->
                                <ng-template pTemplate="emptymessage">
                                    <tr>
                                        <td colspan="8">No customers found.</td>
                                    </tr>
                                    
                                </ng-template>
                            </p-table>
                            </div>
                        </div>
                    </div>
                    <div class=col-3>
                        <h2>&nbsp;&nbsp;&nbsp;Template Preview :</h2>
                        <div class="card shadow-sm p-4 m-4" style="height: 300px">
                            <h2 style="color: rgb(26, 111, 145);">{{ p_name}}</h2>
                            <div style="height: 280px;overflow-y: scroll;" id="scroll-bar-table">
                                <img *ngIf="media_url" src={{media_url}} alt="" style="width:100%;height:100%;"><span
                                    *ngIf="!media_url"></span>
                                <br><br>
                                <p>{{template_body}}</p>
                                <a style="color: dodgerblue;" href="footer" target="_blank">{{footer}}</a>
                            </div>
                        </div>
                    </div>
                </div>
                <div style="margin-left: 400px;">
                    <button title="Run Campaign" type="button" class="btn btn-icon btn-sm me-2" data-bs-toggle="modal"
                        data-bs-target="#myModaladd"
                        style="width: 110px;text-align: center;height: 33px;background-color:#075e54;"
                        (click)="onsend()">
                        <i class="fa fa-paper-plane text-white fs-5"></i>&nbsp; Run Campaign
                    </button>

                </div>
                <br>
            </form>
        </div>
    </div>
    <div class="tab-content" id="myTabContent">
        <div class="tab-pane fade show " id="kt_tab_pane_2" role="tabpanel">
            <form [formGroup]="bulkMessageForm" novalidate="novalidate" (ngSubmit)="onsend()">

                <div class=row>
                    <div class=col-9>
                        <div class="table-responsive">
                            <div class="card card-body m-3 shadow-xl p-3 mb-5 bg-white rounded"
                                style=" max-height: 290px; overflow-y: auto;">
                                <!-- <table id="whatsnamelist"
                                    class="table table-striped table-row-bordered border-bottom gs-7">
                                    <thead>
                                        <tr class=" text-white fw-bold fs-6 text-nowrap bg-whatsapp">
                                            <th style="width:2px;   ">
                                                <input type="checkbox" id="checkAll"
                                                    (change)="$event ? masterToggle() : null"
                                                    [checked]="selection.hasValue() && isAllSelected()"
                                                    [indeterminate]="selection.hasValue() && !isAllSelected()" />
                                            </th>
                                            <th>Name</th>
                                            <th>Contact</th>
                                            <th>Source</th>
                                            <th>Customer Type</th>
                                            <th>Lead Status</th>

                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr *ngFor="let data of contacts_list; let i=index;" class="align-middle">
                                                <td> <input type="checkbox" (click)="$event.stopPropagation()"
                                                        (change)="$event ? selection.toggle(data) : null"
                                                        [checked]="selection.isSelected(data)" />
                                                </td>
                                                <td style="white-space: nowrap;">{{data.displayName}}</td>
                                                <td style="white-space: nowrap;">{{data.value}}</td>
                                                <td style="white-space: nowrap;">{{data.source_name}}<span
                                                        *ngIf="data.source_name ===''">-</span></td>
                                                <td style="white-space: nowrap;">{{data.customer_type}} <span
                                                        *ngIf="data.customer_type ===''">-</span></td>
                                                <td>
                                                    <span *ngIf="data.lead_status === 'Assigned' "><label class="ms-3"
                                                            class="badge bg-success text-white ">Assigned</label></span><span
                                                        *ngIf="data.customer_type ===''">-</span>

                                                    <span *ngIf="data.lead_status === 'Not Assigned'"><label
                                                            class="ms-3" class="badge bg-primary text-white ">Not
                                                            Assigned</label></span>

                                                </td>
                                        </tr>
                                    </tbody>
                                </table> -->
                                <p-table #dt [value]="contacts_list" [(selection)]="selectedCustomer"
                                dataKey="whatsapp_gid" [selectionMode]="" [rowHover]="true" [rows]="200"
                                [showCurrentPageReport]="true" [rowsPerPageOptions]="[200, 500,1000, 1500]" [paginator]="true"
                                currentPageReportTemplate="Showing {first} to {last} of {totalRecords} entries" [filterDelay]="0"
                                paginatorDropdownAppendTo="body" compareSelectionBy="equals" [resizableColumns]="true"
                                [globalFilterFields]="['displayName', 'value', 'source_name', 'customer_type']" class="table table-striped table-row-bordered border-bottom gs-7">
                                <ng-template pTemplate="caption">
                                    <div class="row">
                                        <div class="col-6 table-header">
                                            <h3>Contact Summary</h3> <i class="fas fa-exclamation-circle fs-3" style="color: rgb(76, 146, 244);"></i>&nbsp;&nbsp;<span  style="background-color:rgb(189, 237, 246);"><b>Note :</b> Disabled Checkbox Indicates No Contact Number  </span>
                                        </div>
                                        <div class="col-6">
                                            <span class="p-input-icon-left float-end">
                                                <i class="pi pi-search"></i>
                                                <input pInputText class="form-control" type="text"
                                                    (input)="onGlobalFilterChange($event,dt)" placeholder="Search..." />
                                            </span>
                                        </div>
                                    </div>
                                </ng-template>
                                <ng-template pTemplate="header" let-rowIndex="rowIndex">
                                    <tr class="fs-5">
                                        <th style="width: 2px">
                                            <div class="field-checkbox">
                                                <p-tableHeaderCheckbox></p-tableHeaderCheckbox>
                                            </div>
            
                                        </th>
                                        <th pSortableColumn="displayName">
                                            <div class="flex justify-content-between align-items-center text-white">
                                                Name
                                                <p-sortIcon field="displayName"></p-sortIcon>
            
                                            </div>
                                        </th>
                                                                      
                                        <th pSortableColumn="value" >
                                            <div class="flex justify-content-between align-items-center text-white" >Contact <p-sortIcon
                                                    field="value"></p-sortIcon></div>
                                        </th>
            
                                        <th pSortableColumn="source_name">
                                            <div class="flex justify-content-between align-items-center text-white">Source <p-sortIcon
                                                    field="source_name"></p-sortIcon></div>
                                        </th>
            
                                        <th pSortableColumn="customer_type">
                                            <div class="flex justify-content-between align-items-center text-white">Customer Type
                                                <p-sortIcon field="customer_type"></p-sortIcon>
                                            </div>
                                        </th>
                                      
            
                                    </tr>
            
                                </ng-template>
                                <ng-template pTemplate="body" let-customer>
                                    <tr >
                                        <ng-container *ngIf="customer.sendcampaign_flag==='Y'|| customer.sendcampaign_flag===''">
                                            <td>
                                                <p-tableCheckbox [value]="customer" [disabled]="customer.value === ''" [ngClass]="{'highlight-checkbox': customer.value === ''}"></p-tableCheckbox>
            
                                            </td>
            
                                            <td>
                                                <span class="p-column-title">Name</span>
                                                {{ customer.displayName || '-' }}
                                            </td>
                                            <td>
                                                <span class="p-column-title">Contact</span>{{customer.value || '-'}}
            
                                            </td>
                                            <td>
                                                <span class="p-column-title">Source </span>
                                                {{customer.source_name|| '-'}}
                                            </td>
                                            <td>
                                                <span class="p-column-title">Customer Type</span>
                                                {{customer.customer_type|| '-'}}
                                            </td>
                                        </ng-container>
                                    </tr>
                                </ng-template>
                                <!-- <ng-template pTemplate="paginatorright" let-state>
                                    Total Records: {{ state.totalRecords }}
                                </ng-template>  -->
                                <ng-template pTemplate="emptymessage">
                                    <tr>
                                        <td colspan="8">No customers found.</td>
                                    </tr>
                                    
                                </ng-template>
                            </p-table>
                            </div>
                        </div>
                    </div>
                    <div class=col-3>
                        <h2>&nbsp;&nbsp;&nbsp;Template Preview :</h2>
                        <div class="card shadow-sm p-4 m-4" style="height: 300px">
                            <h2 style="color: rgb(26, 111, 145);">{{ p_name}}</h2>
                            <div style="height: 280px;overflow-y: scroll;" id="scroll-bar-table">
                                <img *ngIf="media_url" src={{media_url}} alt="" style="width:100%;height:100%;"><span
                                    *ngIf="!media_url"></span>
                                <br><br>
                                <p>{{template_body}}</p>
                                <a style="color: dodgerblue;" href="footer" target="_blank">{{footer}}</a>
                            </div>
                        </div>
                    </div>
                </div>
                <div style="margin-left: 400px;">
                    <button title="Run Campaign" type="button" class="btn btn-icon btn-sm me-2" data-bs-toggle="modal"
                        data-bs-target="#myModaladd"
                        style="width: 110px;text-align: center;height: 33px;background-color:#075e54;"
                        (click)="onsend()">
                        <i class="fa fa-paper-plane text-white fs-5"></i>&nbsp;Run Campaign
                    </button>

                </div>
                <br>
            </form>
        </div>
    </div>
</div>