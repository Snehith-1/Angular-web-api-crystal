import { Component } from '@angular/core';
import { FormBuilder, FormControl, FormGroup } from '@angular/forms';
import { SocketService } from 'src/app/ems.utilities/services/socket.service';
import { ToastrService } from 'ngx-toastr';
import { ActivatedRoute, Router } from '@angular/router';

@Component({
  selector: 'app-smr-mst-configuration',
  templateUrl: './smr-mst-configuration.component.html',
  styleUrls: ['./smr-mst-configuration.component.scss']
})
export class SmrMstConfigurationComponent {

  salesconfigform: FormGroup;

  responsedata: any;
  allchargeslist: any;

  ngOnInit(): void {
    var api = 'SmrMstSalesConfig/GetAllChargesConfig';
    this.service.get(api).subscribe((result: any) => {
      this.responsedata = result;
      this.allchargeslist = this.responsedata.salesconfigalllist;

      if(this.allchargeslist[0].flag == 'Y') {
        this.salesconfigform.get("addoncharges")?.setValue(true)
      }

      if(this.allchargeslist[1].flag == 'Y') {
        this.salesconfigform.get("additionaldiscount")?.setValue(true)
      }

      if(this.allchargeslist[2].flag == 'Y') {
        this.salesconfigform.get("freightcharges")?.setValue(true)
      }

      if(this.allchargeslist[3].flag == 'Y') {
        this.salesconfigform.get("packing_forwardingcharges")?.setValue(true)
      }

      if(this.allchargeslist[4].flag == 'Y') {
        this.salesconfigform.get("insurancecharges")?.setValue(true)
      }
    });
  }

  constructor(private formBuilder: FormBuilder, private ToastrService: ToastrService, public service: SocketService, private router: ActivatedRoute, private route: Router) {

    this.salesconfigform = new FormGroup({
      addoncharges: new FormControl(''),
      additionaldiscount: new FormControl(''),
      freightcharges: new FormControl(''),
      packing_forwardingcharges: new FormControl(''),
      insurancecharges: new FormControl('')
    })
  }

  addonchargestoggle() {
    var api = 'SmrMstSalesConfig/UpdateAddOnChargesConfig';
    this.service.post(api, this.salesconfigform.value).subscribe((result: any) => {
      if(result.status == true) {
        this.ToastrService.success(result.message)
      }
      else {
        this.ToastrService.warning(result.message)
      }
    });
  }

  additionaldiscounttoggle() {
    var api = 'SmrMstSalesConfig/UpdateAdditionalDiscountConfig';
    this.service.post(api, this.salesconfigform.value).subscribe((result: any) => {
      if(result.status == true) {
        this.ToastrService.success(result.message)
      }
      else {
        this.ToastrService.warning(result.message)
      }
    });
  }

  freightchargestoggle() {
    var api = 'SmrMstSalesConfig/UpdateFreightChargesConfig';
    this.service.post(api, this.salesconfigform.value).subscribe((result: any) => {
      if(result.status == true) {
        this.ToastrService.success(result.message)
      }
      else {
        this.ToastrService.warning(result.message)
      }
    });
  }

  packing_forwardingchargestoggle() {
    var api = 'SmrMstSalesConfig/UpdatePacking_ForwardingChargesConfig';
    this.service.post(api, this.salesconfigform.value).subscribe((result: any) => {
      if(result.status == true) {
        this.ToastrService.success(result.message)
      }
      else {
        this.ToastrService.warning(result.message)
      }
    });
  }

  insurancechargestoggle() {
    var api = 'SmrMstSalesConfig/UpdateInsuranceChargesConfig';
    this.service.post(api, this.salesconfigform.value).subscribe((result: any) => {
      if(result.status == true) {
        this.ToastrService.success(result.message)
      }
      else {
        this.ToastrService.warning(result.message)
      }
    });
  }
}
